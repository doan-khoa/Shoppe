if (self.CavalryLogger) { CavalryLogger.start_js(["Lz8K7ju"]); }

__d("upgradedUFI2GroupMentionsComposerPluginCreatorWithTypeaheadViewForDraftjs",["CometMentions.react","FeedComposerCometMentionsTypeaheadListItemResolver.react","Keys","MentionSpan.react","WeakMentionSpan.react","cometReplaceMentionedTextInEditorState","createCometComposerMentionsEntity","createUpgradedUFI2MentionsComposerPluginAnchorDecorator","getCometComposerMentionsSearch","getEntityMatcher","installUFI2ComposerInputDecorators","react","recoverableViolation","upgradedUFI2MentionsComposerPluginDraftUtils","useCometMentionsLoggingProvider","useGroupsCometComposerMentionsDataSourceResolverConfig","usePrevious","useUpgradedUFI2MentionsComposerPluginInstaller"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useCallback,i=b.useEffect,j=b.useImperativeHandle,k=b.useMemo,l=b.useRef,m=b.useState,n=d("react"),o={component:c("MentionSpan.react"),strategy:c("getEntityMatcher")(function(a){return a.getType()==="MENTION"})},p={component:c("WeakMentionSpan.react"),strategy:c("getEntityMatcher")(function(a){return a.getType()==="MENTION"?!!((a=a.getData())==null?void 0:a.isWeak):!1})};function a(){return function(a){var b=a.groupID;function e(){return n.forwardRef(function(a,e){var f=a.inputProps,g=f.composerState,r=f.onBlur,s=f.onComposerStateChange,t=f.onFocus;f=a.onInstallContentBlockToTextWithEntitiesInputMessageMappers;c("useUpgradedUFI2MentionsComposerPluginInstaller")(f);a=m(!1);f=a[0];var u=a[1],v=l(null),w=l(!1);a=m(null);var x=a[0],y=a[1];a=c("useGroupsCometComposerMentionsDataSourceResolverConfig")({enableMentionsSeeMoreDecorator:!1,groupID:b,limit:5,shouldBootstrapOnLayoutEffect:!1});var z=a.bootstrap,A=a.resolver,B=d("upgradedUFI2MentionsComposerPluginDraftUtils").getMaybeEditorState(g),C=c("usePrevious")(g);i(function(){var a=g.inputState;if(C==null)return;var b=C.inputState;if(a.__type==="editor-state-based"&&(b.__type!=="editor-state-based"||b.__type==="editor-state-based"&&b.editorState!==a.editorState)){b=c("getCometComposerMentionsSearch")(a.editorState);y(b);u(!1)}else return},[g,C]);var D=h(function(a){s(function(b){return babelHelpers["extends"]({},b,{ariaInputs:a})})},[s]),E=h(function(a){r&&r(a),D()},[r,D]),F=h(function(a){z(),t&&t(a)},[z,t]),G=h(function(a,b){var d=v.current,e=w.current;if(a.keyCode===c("Keys").ESC&&x!=null){e&&(a.preventDefault(),a.stopPropagation());return"MentionsAutocomplete/cancel"}if(d!=null&&e)switch(a.keyCode){case c("Keys").DOWN:a.preventDefault();return"MentionsAutocomplete/next-mention";case c("Keys").RETURN:if(d.hasSelection()){a.preventDefault();return"MentionsAutocomplete/select-mention"}break;case c("Keys").TAB:if(d.hasSelection()){a.preventDefault();return"MentionsAutocomplete/select-mention"}break;case c("Keys").UP:a.preventDefault();return"MentionsAutocomplete/previous-mention"}b&&b(a)},[x]),H=h(function(a){var b=v.current;switch(a){case"MentionsAutocomplete/cancel":u(!0);break;case"MentionsAutocomplete/select-mention":b&&b.select();break;case"MentionsAutocomplete/previous-mention":b&&b.moveUp();break;case"MentionsAutocomplete/next-mention":b&&b.moveDown();break}return"not-handled"},[]);a=h(function(a){var b=g.inputState;if(B==null||b.__type!=="editor-state-based")return;b=c("getCometComposerMentionsSearch")(B);if(b==null){c("recoverableViolation")("Race condition where the user selected a mention but theres no text in the editor","search");return}b=A(b);b=b.searchResult;if(b==null){c("recoverableViolation")("onPressEntry was called and no search result was found for the query","CometComposer");return}D();var d=c("cometReplaceMentionedTextInEditorState")(a,B,b.replaceableString.length,function(a,b){return c("createCometComposerMentionsEntity")(b.getKey(),!1,a)},function(){return a.getLabel()});s(function(a){return q(a,d)})},[g,A,D,B,s]);var I=c("useCometMentionsLoggingProvider")(),J=l(null),K=k(function(){return c("createUpgradedUFI2MentionsComposerPluginAnchorDecorator")(A,J)},[A]);j(e,function(){return{getUpgradedProps:function(a){var b=a.inputProps;a=babelHelpers.objectWithoutPropertiesLoose(a,["inputProps"]);return babelHelpers["extends"]({},a,{inputProps:babelHelpers["extends"]({},b,{composerState:c("installUFI2ComposerInputDecorators")(b.composerState,K,p,o),handleKeyCommand:function(a){return H(a)},keyBindingFn:function(a){return G(a,b.keyBindingFn)},onBlur:E,onFocus:F})})}}});e=h(function(a){w.current=a},[]);var L=h(function(a){if(a)return;D()},[D]),M=h(function(a,b){(a==null||b==null)&&D(),D({"aria-activedescendant":a,"aria-controls":b})},[D]);if(f){w.current=!1;return null}f=J.current;if(f==null){w.current=!1;return null}var N=A(x),O=N.dataSource;N=N.searchResult;if(N==null||O==null){w.current=!1;return null}return n.jsx(c("CometMentions.react"),{context:f,dataSource:O,editorHasFocus:!0,loggingProvider:I,onAriaChange:M,onBlur:E,onEntriesUpdated:L,onFocus:F,onSelectedEntry:a,onVisibilityChange:e,position:"below",queryString:N.matchingString,ref:v,viewItemStrategyRenderer:c("FeedComposerCometMentionsTypeaheadListItemResolver.react")})})}return e}}function q(a,b){var d=a.inputState;if(d.__type==="editor-state-based"){b=babelHelpers["extends"]({},a,{inputState:babelHelpers["extends"]({},d,{editorState:b})});return b}c("recoverableViolation")("Unimplemented: tried to commit a searchable entity as a mention to a UFI2ComposerState "+("with an inputState of type "+d.__type+". ")+'Only the "editor-state-based" type is supported at the moment',"search");return a}g["default"]=a}),98);
__d("createUpgradedUFI2GroupMentionsComposerPluginForDraftjs",["upgradedUFI2GroupMentionsComposerPluginCreatorWithTypeaheadViewForDraftjs"],(function(a,b,c,d,e,f,g){"use strict";a=c("upgradedUFI2GroupMentionsComposerPluginCreatorWithTypeaheadViewForDraftjs")();g["default"]=a}),98);
__d("UserSignalsClientImpressionEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1968720");c=b("FalcoLoggerInternal").create("user_signals_client_impression_event",a);e.exports=c}),null);